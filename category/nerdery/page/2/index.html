<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xmlns:fb="http://ogp.me/ns/fb#" xmlns:addthis="http://www.addthis.com/help/api-spec" >

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>chmullig.com  &raquo; Nerdery</title>

<link rel="stylesheet" href="../../../../wp-content/themes/clean-home/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../wp-content/themes/clean-home/style.css" type="text/css" media="screen" />
<!--[if IE]><link rel="stylesheet" href="http://chmullig.com/wp-content/themes/clean-home/ie.css" type="text/css" media="screen" /><![endif]-->
<link rel="alternate" type="application/rss+xml" title="chmullig.com RSS Feed" href="../../../../feed/index.html" />
<link rel="pingback" href="http://chmullig.com/xmlrpc.php" />

<link rel="alternate" type="application/rss+xml" title="chmullig.com &raquo; Nerdery Category Feed" href="../../feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/chmullig.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.2"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jetpack-subscriptions-css'  href='../../../../wp-content/plugins/jetpack/modules/subscriptions/subscriptions.css?ver=4.2.2' type='text/css' media='all' />
<link rel='stylesheet' id='output-css'  href='../../../../wp-content/plugins/addthis/css/output.css?ver=4.2.2' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='../../../../wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widgets-css'  href='../../../../wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20121003' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css'  href='../../../../wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=3.1.2' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../../../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css?ver=3.1' type='text/css' media='all' />
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery.js?ver=1.11.2'></script>
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.7.3'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.2.2" />
<!-- Google Analytics Tracking by Google Analyticator 6.4.7.3: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">window.google_analytics_uacct = "pub-9101413482443756   ";</script>
<script type="text/javascript">
                var analyticsFileTypes = [''];
                            var analyticsSnippet = 'enabled';
                var analyticsEventTracking = 'enabled';
            </script>
<script type="text/javascript">
	var _gaq = _gaq || [];
  
	_gaq.push(['_setAccount', 'UA-11155757-1']);
    _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>

</head>

<body>

<div id="wrapper">

	<div id="header">
		<div id="logo">
		<h1><a href="../../../../index.html">chmullig.com</a></h1>
		<h2>Chris Mulligan&#039;s blog on life, computers, burritos, school</h2>
		</div>
		<div id="nav">
					<ul>
				<li class="page_item page-item-2"><a href="../../../../about/index.html">Me</a></li>
<li class="page_item page-item-284"><a href="../../../../projects/index.html">Projects</a></li>
			</ul>
				</div>
	</div>


	<div id="content">
	
				
		<div class="post">
			<h1><a href="../../../../2011/03/voter-file-documentation-project/index.html">Voter File Documentation Project?</a></h1>
			<small><b>Posted:</b> March 12th, 2011 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>, <a href="../../../politics/index.html" rel="category tag">politics</a>  | <b>Tags:</b> <a href="../../../../tag/data/index.html" rel="tag">data</a>, <a href="../../../../tag/documentation/index.html" rel="tag">documentation</a>, <a href="../../../../tag/voter-file/index.html" rel="tag">voter file</a> | <a href="../../../../2011/03/voter-file-documentation-project/index.html#respond">No Comments &#187;</a></small>
			<p>Political Data Nerds,</p>
<p>I&#8217;ve spent far, far too many hours of my life working with voter files. Every voter file sucks in its own unique way, and figuring out exactly how Montana sucks differently from Kansas is a unique and constant battle. Well, I&#8217;m tired of it! I don&#8217;t want to have to re-learn these challenges next time I work on a file, I don&#8217;t want to dig for the raw documentation (only to realize that it&#8217;s not always accurate).</p>
<p>I&#8217;m thinking of starting/contributing to a resource that consolidates <em>documentation</em> on all voter files out there. It wouldn&#8217;t be the data, it would just be freely available documentation to help anyone who&#8217;s already working with the data work with it more easily. What do you think?</p>
<p>I imagine it would have a list of vendors who provide these services as well, but the focus would be on helping anyone who&#8217;s trying to do it themselves. Probably should also have some more general tech recommendations, like how to concatenate files together, standardize addresses, geocode, etc.</p>
<p>Questions it would most definitely answer for every voter file (at least states, counties aren&#8217;t that important to me right now):</p>
<ul>
<li>Where can I request this, and how much does it cost?</li>
<li>What format is it? CSV? Tab delimited text? Does it have a header? One file per county, or one per state?</li>
<li>How is vote history stored?</li>
<li>How do I translate from their geopolitical districts to something &#8220;standard?&#8221;</li>
<li>How do I translate from their counties to county FIPS codes?</li>
<li>What fields does it contain? Name? Address? Date of Birth? Phone? Party?</li>
<li>Mapping their vote history to some more global standard (for the common elections).</li>
</ul>
<p>This wouldn&#8217;t be doing anything for you, but hopefully it would ease the pain of anyone having to work with raw voter files.</p>
<p>Pew&#8217;s <a title="Data For Democracy PDF" href="http://www.pewcenteronthestates.org/uploadedFiles/Final%20DfD.pdf" target="_blank">Data for Democracy report</a> is an excellent start. However it&#8217;s a static and higher level document. I&#8217;d like a living document that contains more concrete information, and can be easily updated.</p>
<p>Does anyone know of an existing project doing this that I could contribute to? If not, are there any platforms better than Mediawiki to use? I&#8217;d rather not spend a lot of time writing original code for this, but that might be inevitable if I don&#8217;t want to do a ton of copy/pasting in mediawiki (boy does Mediawiki suck, too)&#8230;</p>
			<a href="../../../../2011/03/voter-file-documentation-project/index.html#respond">No Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2011/02/mitre-challenge-graph/index.html">MITRE Challenge Graph</a></h1>
			<small><b>Posted:</b> February 23rd, 2011 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/graph/index.html" rel="tag">graph</a>, <a href="../../../../tag/matching/index.html" rel="tag">matching</a>, <a href="../../../../tag/mitre/index.html" rel="tag">mitre</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a>, <a href="../../../../tag/r/index.html" rel="tag">r</a> | <a href="../../../../2011/02/mitre-challenge-graph/index.html#comments">13 Comments &#187;</a></small>
			<p>For my own curiosity I created a python + R script to grab the MITRE leaderboard and graph it. It&#8217;s a <a href="http://a.libpa.st/Wor48">bit of python</a> to grab the leaderboard and write out some CSVs. Then a bit of <strike><a href="http://a.libpa.st/0_3Kh">R code</a></strike> (updated link: <a href="http://a.libpa.st/4KFGq">http://a.libpa.st/4KFGq</a>) generates the graph. It&#8217;s running automatically with launchd on my laptop, and it should be regularly uploading a png to the address below. Launchd is pretty awesome, but a royal pain in the ass to get set up. It doesn&#8217;t feel very deterministic.</p>
<p>I still need to figure out how to jitter the names so they don&#8217;t overlap (like YouGov &amp; Agent Smith), but other than that I thought it was a nifty little exercise.</p>
<div style="width: 590px" class="wp-caption alignnone"><img title="Leader Board Graphed over time" src="../../../../mitre_leaderboard.png" alt="" width="580" height="580" /><p class="wp-caption-text">Each line is a team, with their best MAP scores as datapoints</p></div>
			<a href="../../../../2011/02/mitre-challenge-graph/index.html#comments">13 Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2011/02/mitre-name-matching-challenge/index.html">MITRE Name Matching Challenge</a></h1>
			<small><b>Posted:</b> February 17th, 2011 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/programming/index.html" rel="tag">programming</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a>, <a href="../../../../tag/work/index.html" rel="tag">work</a> | <a href="../../../../2011/02/mitre-name-matching-challenge/index.html#respond">No Comments &#187;</a></small>
			<p>My illustrious former colleague Ryan is now over at MITRE doing operations research and who knows what. He pointed me toward the <a href="http://chmullig.com/category/nerdery/page/2/mitrechallenge.mitre.org/NameMatching">MITRE Challenge</a>.</p>
<blockquote><p>The MITRE Challenge™ is an ongoing, open competition to encourage innovation in technologies of interest to the federal government. The current competition involves multicultural person name matching, a technology whose uses include vetting persons against a watchlist (for screening, credentialing, and other purposes) and merging or deduplication of records in databases. Person name matching can also be used to improve document searches, social network analysis, and other tasks in which the same person might be referred to by multiple versions or spellings of a name.</p></blockquote>
<p>Basically they give you a small list of target names, and a ginormous list of candidate names, and for each target name you return up to 500 possible matches from the candidate name list. Currently the matching software we built at Polimetrix back in 2005-2007 is doing pretty well. It was designed for full voter records, but I broke out the name component by itself. The result is pretty awesome. Currently we&#8217;re ranked #1 at 72.038. Below us are a few teams, including Intaka at 68.801 and Beethoven at 58.501.</p>
			<a href="../../../../2011/02/mitre-name-matching-challenge/index.html#respond">No Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2011/02/stackoverflow-overflow/index.html">Stackoverflow overflow</a></h1>
			<small><b>Posted:</b> February 9th, 2011 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/programming/index.html" rel="tag">programming</a>, <a href="../../../../tag/stackoverflow/index.html" rel="tag">stackoverflow</a> | <a href="../../../../2011/02/stackoverflow-overflow/index.html#comments">3 Comments &#187;</a></small>
			<p>Recently <a title="chmullig on stackoverflow" href="http://stackoverflow.com/users/349931/chmullig">I&#8217;ve</a> gotten a bit obsessed with <a href="http://stackoverflow.com/">stackoverflow.com</a>. It&#8217;s a programming Q&amp;A site. You can ask questions, you can answer and comment on them. However they have a sick twist &#8211; people vote on everything. They vote on your questions, answers, comments. You earn reputation points when your content is voted up, and you lose points when it&#8217;s voted down. You also earn badges, like gaming achievements.</p>
<p>They&#8217;ve recently started a whole bunch of related sites under the <a href="http://stackexchange.com/">stackexchange</a> brand. Same model and software, but with different subjects. So far there are already <a href="http://stackexchange.com/sites">more than I care to count</a> with only very spurious differentiation, but a few highlights include <a href="http://gaming.stackexchange.com">gaming</a>, <a href="http://cooking.stackexchange.com">cooking</a>, <a href="http://english.stackexchange.com">english</a>, <a href="http://programmers.stackexchange.com">programming</a> (as a profession), <a title="Super User" href="http://superuser.com/">power users</a>, <a title="Server Fault" href="http://serverfault.com/">sysadmin</a>, <a href="http://linux.stackexchange.com">linux</a>, <a title="Ask Ubuntu" href="http://askubuntu.com">ubuntu</a>, and a lot more.</p>
<p>Here&#8217;s my badge of honor. Right now I have 674 rep and 10 badges on Stackoverflow, and 261/4 on gaming (plus ~100 on a bunch of the other sites, just for signing up). That&#8217;s my profile image, which should update automatically!<br />
<a href="http://stackoverflow.com/users/349931/chmullig"><br />
<img title="Stack Overflow profile for chmullig at Stack Overflow, Q&amp;A for professional and enthusiast programmers" src="http://stackoverflow.com/users/flair/349931.png" alt="Stack Overflow profile for chmullig at Stack Overflow, Q&amp;A for professional and enthusiast programmers" width="208" height="58" /><br />
</a></p>
<p>It&#8217;s amazing how satisfying and competitive the Q&amp;A system ends up. I find myself less and less interested in any other medium for asking or answering questions like the kind on Stackoverflow. It&#8217;s slow and there&#8217;s no rep, what&#8217;s the point?</p>
			<a href="../../../../2011/02/stackoverflow-overflow/index.html#comments">3 Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2010/11/programming-challenges/index.html">Programming Challenges</a></h1>
			<small><b>Posted:</b> November 11th, 2010 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/challenge/index.html" rel="tag">challenge</a>, <a href="../../../../tag/programming/index.html" rel="tag">programming</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a>, <a href="../../../../tag/r/index.html" rel="tag">r</a> | <a href="../../../../2010/11/programming-challenges/index.html#respond">No Comments &#187;</a></small>
			<p>I&#8217;m a fan of puzzles, programming and learning, so I&#8217;ve always enjoyed <a href="http://www.pythonchallenge.com/">The Python Challenges</a>. Recently my coworkers Delia, Chris and I came up with the idea of doing some of those within the company to help ourselves and our coworkers become more familiar with Python and R (and to a lesser extent SQL and other languages).</p>
<p>The end result is the <a href="http://ygchallenge.wordpress.com/">YG Challenge</a>, where we&#8217;ll be posting a few problems a week in at least R &amp; Python, then solving them. Week 1 is up, and we have some great ideas for the future. Intended for our coworkers, it&#8217;s public because why not! Feel free to take a stab at solving them, especially if you haven&#8217;t used either of those languages before.</p>
			<a href="../../../../2010/11/programming-challenges/index.html#respond">No Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2010/05/pmxbot-command-lunch/index.html">pmxbot command: lunch!</a></h1>
			<small><b>Posted:</b> May 14th, 2010 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/pmxbot/index.html" rel="tag">pmxbot</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a> | <a href="../../../../2010/05/pmxbot-command-lunch/index.html#respond">No Comments &#187;</a></small>
			<p>As everyone is well aware, lunch is the most important part of the work day. However it&#8217;s often <a href="http://lunchstr.appspot.com/">hard</a> to find <a href="http://lunchster.com/">inspiration</a> when deciding on a delectable dining destination. The ideal solution is to have someone propose options, and everyone reject them until consensus is reached. However nobody enjoys that. Computers can <a title="Urban Spoon's slot machine widget" href="http://www.urbanspoon.com/spin-widget">propose options</a>, but that&#8217;s less social.</p>
<p>pmxbot has an existing !lunch command that&#8217;s supposed to help. Unfortunately you have to fill out the dining list yourself, and frankly, that&#8217;s a pain. The result is lots of old, bad definitions in a few limited areas. It does let you sneak in some comedy options (What to have in Canton? PB&amp;J? Leftovers?), but for the main purpose it kinda sucks.</p>
<p>The solution is to use someone else&#8217;s database. I cooked one up yesterday pretty quickly using <a title="Yahoo Local" href="http://local.yahoo.com/">Yahoo Local&#8217;s</a> <a title="Yahoo Local Search API Documentation" href="http://developer.yahoo.com/search/local/V3/localSearch.html">API</a> and the <a title="pYsearch: Python APIs for Y! search services" href="http://pysearch.sourceforge.net/docs/yahoo.search.local.html">pYsearch</a> convenience module. The result is quite easy, really. The only wrinkle is you need that module (someone could rewrite it to use just urllib and simplejson, if they cared) and a Yahoo API key.</p>
<p>The code is below, also available at <a href="http://libpa.st/2K0kh">http://libpa.st/2K0kh</a>.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;lunch&quot;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Find a random neary restaurant for lunch using Yahoo Local. Defaults to 1 mile radius, but append Xmi to the end to change the radius.&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> lunch<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">from</span> yahoo.<span style="color: black;">search</span>.<span style="color: black;">local</span> <span style="color: #ff7700;font-weight:bold;">import</span> LocalSearch
        location <span style="color: #66cc66;">=</span> rest.<span style="color: black;">strip</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> location.<span style="color: black;">endswith</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'mi'</span><span style="color: black;">&#41;</span>:
                radius<span style="color: #66cc66;">,</span> location <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: #008000;">reversed</span><span style="color: black;">&#40;</span>location<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>.<span style="color: black;">split</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">' '</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
                location <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: #008000;">reversed</span><span style="color: black;">&#40;</span>location<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
                radius <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: #008000;">reversed</span><span style="color: black;">&#40;</span>radius<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
                radius <span style="color: #66cc66;">=</span> <span style="color: #008000;">float</span><span style="color: black;">&#40;</span>radius.<span style="color: black;">replace</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'mi'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">''</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
                radius <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
        srch <span style="color: #66cc66;">=</span> LocalSearch<span style="color: black;">&#40;</span>app_id<span style="color: #66cc66;">=</span>yahooid<span style="color: #66cc66;">,</span> category<span style="color: #66cc66;">=</span><span style="color: #ff4500;">96926236</span><span style="color: #66cc66;">,</span> results<span style="color: #66cc66;">=</span><span style="color: #ff4500;">20</span><span style="color: #66cc66;">,</span> query<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;lunch&quot;</span><span style="color: #66cc66;">,</span> location<span style="color: #66cc66;">=</span>location<span style="color: #66cc66;">,</span> radius<span style="color: #66cc66;">=</span>radius<span style="color: black;">&#41;</span>
        res <span style="color: #66cc66;">=</span> srch.<span style="color: black;">parse_results</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #008000;">max</span> <span style="color: #66cc66;">=</span> res.<span style="color: black;">totalResultsAvailable</span> <span style="color: #ff7700;font-weight:bold;">if</span> res.<span style="color: black;">totalResultsAvailable</span> &amp;lt<span style="color: #66cc66;">;</span> <span style="color: #ff4500;">250</span> <span style="color: #ff7700;font-weight:bold;">else</span> <span style="color: #ff4500;">250</span>
        num <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">random</span>.<span style="color: black;">randint</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">max</span><span style="color: black;">&#41;</span> - <span style="color: #ff4500;">1</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> num &amp;lt<span style="color: #66cc66;">;</span> <span style="color: #ff4500;">19</span>:
                choice <span style="color: #66cc66;">=</span> res.<span style="color: black;">results</span><span style="color: black;">&#91;</span>num<span style="color: black;">&#93;</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
                srch <span style="color: #66cc66;">=</span> LocalSearch<span style="color: black;">&#40;</span>app_id<span style="color: #66cc66;">=</span>yahooid<span style="color: #66cc66;">,</span> category<span style="color: #66cc66;">=</span><span style="color: #ff4500;">96926236</span><span style="color: #66cc66;">,</span> results<span style="color: #66cc66;">=</span><span style="color: #ff4500;">20</span><span style="color: #66cc66;">,</span> query<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;lunch&quot;</span><span style="color: #66cc66;">,</span> location<span style="color: #66cc66;">=</span>location<span style="color: #66cc66;">,</span> start<span style="color: #66cc66;">=</span>num<span style="color: black;">&#41;</span>
                res <span style="color: #66cc66;">=</span> srch.<span style="color: black;">parse_results</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
                choice <span style="color: #66cc66;">=</span> res.<span style="color: black;">results</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">'%s @ %s - %s'</span> % <span style="color: black;">&#40;</span>choice<span style="color: black;">&#91;</span><span style="color: #483d8b;">'Title'</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> choice<span style="color: black;">&#91;</span><span style="color: #483d8b;">'Address'</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> choice<span style="color: black;">&#91;</span><span style="color: #483d8b;">'Url'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

			<a href="../../../../2010/05/pmxbot-command-lunch/index.html#respond">No Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2010/05/library-paste/index.html">Library Paste</a></h1>
			<small><b>Posted:</b> May 3rd, 2010 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/library-paste/index.html" rel="tag">library paste</a>, <a href="../../../../tag/paste/index.html" rel="tag">paste</a>, <a href="../../../../tag/pmxbot/index.html" rel="tag">pmxbot</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a> | <a href="../../../../2010/05/library-paste/index.html#respond">No Comments &#187;</a></small>
			<p>The ever impressive <a title="Jamie Turner aka jamwt" href="http://jamwt.com">Jamie</a> wrote a nice little paste bin at work a while back. It was dead simple to use, relatively private (in that it used <a title="Universally Unique IDs - really long random letters and numbers" href="http://en.wikipedia.org/wiki/Universally_Unique_Identifier">UUIDs</a> and didn&#8217;t have an index), and hooked into <a href="http://bitbucket.org/yougov/pmxbot">pmxbot</a>. Unfortunately like most of the code written internally it used a proprietary web framework that&#8217;s not open source. It&#8217;s like <a title="CherryPy" href="http://cherrypy.org">cherrypy</a> &amp; <a title="Cheetah Templates" href="http://www.cheetahtemplate.org/">cheetah</a>, but different.</p>
<p>I decided to modify jamwt&#8217;s pastebin to make it open sourceable. It&#8217;s now up on BitBucket as <strong><a title="Library Paste" href="http://bitbucket.org/chmullig/librarypaste">Library Paste</a>.</strong> It uses cherrypy with <a href="http://routes.groovie.org/">Routes</a> (<em>NB: Must use routes &lt;1.12 due to </em><a title="Cherrypy ticket #1010: Routes Dispatcher doesn't work with Routes 1.12.1" href="http://www.cherrypy.org/ticket/1010">#1010</a>), <a href="http://www.makotemplates.org/">mako</a> for templating, <a href="http://code.google.com/p/simplejson/">simplejson</a> plus flat files for a database, and <a href="http://pygments.org/">pygments</a> for syntax highlighting. One of the great features is that it also allows one click sharing of files, particularly images. How handy is that?</p>
<p>For code &#8211; you specify a Pygments lexer to use and it will highlight it with that when displayed. You can leave it unhighlighted, and always get the plain text original.</p>
<p>For files &#8211; it will take anything. It will read the mime type when you upload it, and set it on output. It will tell your browser to display it inline, but it will also set the filename correctly so if you save it you&#8217;ll get whatever it was uploaded with, rather than the ugly uuid with no file extension.</p>
<p>There are a few minor improvements from the in house original. First, the upload file is on the same page rather than separated from uploading code. Second, it handles file names with spaces better. Third, there is no third.</p>
<p>I&#8217;d really like to get configuration/deployment setup. What&#8217;s considered a good, flexible way to to make it easy for folks to deploy an app like this? Use cherrypy config files, build a little bin script and optionally let folks run it behind wsgi if they want to nginx/apache it?</p>
<p>I&#8217;d also like to try with putting it up on <a href="http://code.google.com/appengine/">Google App Engine</a>. Looks like you have to jump through a few hoops to adjust code to use it, and I&#8217;d have to adapt the flat file system to use their DB.</p>
<p>One nifty &#8220;hidden&#8221; feature it has is that you can ask it for the last UUID posting for a given user, if they filled in the nickname. You simple visit http://host/last/user and get back a plain text response with the UUID. pmxbot can use this to provide a link to someone&#8217;s most recent paste. Here&#8217;s the generic pmxbot function we used.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;paste&quot;</span><span style="color: #66cc66;">,</span> aliases<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Drop a link to your latest paste on paste&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> paste<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
    post_id <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">urllib</span>.<span style="color: black;">urlopen</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;http://paste./last/%s&quot;</span> % nick<span style="color: black;">&#41;</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">if</span> post_id:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">'http://paste/%s'</span> % post_id
    <span style="color: #ff7700;font-weight:bold;">else</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">&quot;hmm.. I didn't find a recent paste of yours, %s. Try http://paste to add one.&quot;</span> % nick</pre></td></tr></table></div>


		<style type='text/css'>
			#gallery-1 {
				margin: auto;
			}
			#gallery-1 .gallery-item {
				float: left;
				margin-top: 10px;
				text-align: center;
				width: 33%;
			}
			#gallery-1 img {
				border: 2px solid #cfcfcf;
			}
			#gallery-1 .gallery-caption {
				margin-left: 0;
			}
			/* see gallery_shortcode() in wp-includes/media.php */
		</style>
		<div id='gallery-1' class='gallery galleryid-103 gallery-columns-3 gallery-size-thumbnail'><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='../../../../wp-content/uploads/2010/05/librarypaste_input.png'><img width="150" height="150" src="../../../../wp-content/uploads/2010/05/librarypaste_input-150x150.png" class="attachment-thumbnail" alt="The input/home screen for adding a new paste. Earlier users note - file input on the same page." aria-describedby="gallery-1-105" /></a>
			</dt>
				<dd class='wp-caption-text gallery-caption' id='gallery-1-105'>
				The input/home screen for adding a new paste. Earlier users note &#8211; file input on the same page.
				</dd></dl><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='../../../../wp-content/uploads/2010/05/librarypaste_code.png'><img width="150" height="150" src="../../../../wp-content/uploads/2010/05/librarypaste_code-150x150.png" class="attachment-thumbnail" alt="Showing some syntax highlighted code (indeed, Library Paste itself. The pastebin equivalent of boostrapping?)" aria-describedby="gallery-1-107" /></a>
			</dt>
				<dd class='wp-caption-text gallery-caption' id='gallery-1-107'>
				Showing some syntax highlighted code (indeed, Library Paste itself. The pastebin equivalent of boostrapping?)
				</dd></dl><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='../../../../wp-content/uploads/2010/05/librarypaste_img.png'><img width="150" height="150" src="../../../../wp-content/uploads/2010/05/librarypaste_img-150x150.png" class="attachment-thumbnail" alt="An image being served up by library paste. It automatically sets the mime type and filename based on what was uploaded." aria-describedby="gallery-1-108" /></a>
			</dt>
				<dd class='wp-caption-text gallery-caption' id='gallery-1-108'>
				An image being served up by library paste. It automatically sets the mime type and filename based on what was uploaded.
				</dd></dl><br style="clear: both" />
		</div>

<h3>Update:</h3>
<p>I&#8217;ve since made a google app engine compatible version. It&#8217;s publicly hosted and you&#8217;re welcome to use it. <a href="http://librarypastebin.appspot.com">http://librarypastebin.appspot.com</a> and at <a href="http://libpa.st"><strong>http://libpa.st</strong></a>. Yes, I bought a stupid short URL for it!</p>
			<a href="../../../../2010/05/library-paste/index.html#respond">No Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2010/04/custom-pmxbot-actions/index.html">Custom pmxbot actions</a></h1>
			<small><b>Posted:</b> April 7th, 2010 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/irc/index.html" rel="tag">irc</a>, <a href="../../../../tag/pmxbot/index.html" rel="tag">pmxbot</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a> | <a href="../../../../2010/04/custom-pmxbot-actions/index.html#comments">3 Comments &#187;</a></small>
			<p>My employer just open sourced a fork of the IRC bot we&#8217;ve been using internally for years, <a title="bitbucket pmxbot" href="http://bitbucket.org/yougov/pmxbot">pmxbot</a>. <a title="Jamie Turner" href="http://jamwt.com">jamwt</a> and some others are responsible for all the good parts of it, but I&#8217;ve been responsible for most of the feature bloat for the past few years. The open source version strips out internal code that or didn&#8217;t need to be shared, and overall makes it much more flexible for others to use.</p>
<p>It&#8217;s really a pretty great system, and I&#8217;m going to share some of the actions that we didn&#8217;t release, but that you might get some value or inspiration from. Of note, a few of these will reference internal libraries, so you&#8217;ll need to switch &#8217;em to use urllib2 or similar.</p>
<p>The basic way you extend pmxbot is with two decorators. The first is @command, and the second is @contains. @commands are commands you explicitly call with &#8220;!command&#8221; at the  beginning of a line. @contains is a very simple pattern match &#8211; if the phrase you register is in the line (literally &#8220;name in lc_msg&#8221;).</p>
<p>When you use the decorators on a function you&#8217;re adding it to pmxbot&#8217;s handler_registry. Every line of chat it sees will then be checked to see if an appropriate action exists in the registry, and if so the function is called. It goes through the registry in a certain order &#8211; first commands, then aliases, then contains. Within each group it also sorts by descending length order &#8211; so if you have two contains &#8211; &#8220;rama lama ding dong&#8221; and &#8220;ram&#8221; &#8211; if a line had &#8220;rama lama ding dong&#8221; it would execute that one. pmxbot will execute exactly 0 or 1 actions for any line.</p>
<p>The decorators are fairly simple &#8211; @command(&#8220;google&#8221;, aliases=(&#8216;g&#8217;,), doc=&#8221;Look a phrase up on google, new method&#8221;). First is the name of the command &#8220;google&#8221;, which you trigger by entering &#8220;!google.&#8221; Second is an optional iterator of aliases, in this case only one, &#8220;!g.&#8221; You could have several in here, such as aliases=(&#8216;shiv&#8217;, &#8216;stab&#8217;, &#8216;shank&#8217;,). Last is an optional help/documentation string that will be displayed when someone does &#8220;!help google&#8221;. The contains decorator is the same, but uses @contains and doesn&#8217;t support aliases.</p>
<p>A command is called when it&#8217;s picked out of the handler registry to handle the action. Any handler will be called with the arguments &#8211; client, event, channel, nick and rest. You can ignore client and event for 99% of cases, they&#8217;re passed through from the underlying irc library. Channel is a string containing the channel the command was made in. Nick is the nickname of the person who made the call. Rest is the rest of the message, after the command prefix is removed if it&#8217;s a command. For example if we saw the following line in #pmxbot: &#8220;&lt;chmullig&gt; !g wikipedia irc bots&#8221; the google function would be called with channel == &#8220;#pmxbot&#8221;, nick == &#8220;chmullig&#8221; and rest == &#8220;wikipedia irc bots&#8221;.</p>
<h2>A basic command</h2>
<p>Putting it all together, let&#8217;s look at a basic command &#8211; !google.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;google&quot;</span><span style="color: #66cc66;">,</span> aliases<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'g'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Look a phrase up on google&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> google<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	BASE_URL <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;amp;'</span>
	url <span style="color: #66cc66;">=</span> BASE_URL + <span style="color: #dc143c;">urllib</span>.<span style="color: black;">urlencode</span><span style="color: black;">&#40;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">'q'</span> : rest.<span style="color: black;">strip</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><span style="color: black;">&#41;</span>
	raw_res <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">urllib</span>.<span style="color: black;">urlopen</span><span style="color: black;">&#40;</span>url<span style="color: black;">&#41;</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
	results <span style="color: #66cc66;">=</span> json.<span style="color: black;">loads</span><span style="color: black;">&#40;</span>raw_res<span style="color: black;">&#41;</span>
	hit1 <span style="color: #66cc66;">=</span> results<span style="color: black;">&#91;</span><span style="color: #483d8b;">'responseData'</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'results'</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
	<span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">' - '</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">urllib</span>.<span style="color: black;">unquote</span><span style="color: black;">&#40;</span>hit1<span style="color: black;">&#91;</span><span style="color: #483d8b;">'url'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> hit1<span style="color: black;">&#91;</span><span style="color: #483d8b;">'titleNoFormatting'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>It registers the function google, under the command google, with an alias g. Note that the google function doesn&#8217;t have to match the name in the decorator, it can be anything. Within this function we can do anything you could want to do in python &#8211; we use urllib to call google&#8217;s ajax apis, and use simplejson to parse it and return the URL and title of the first hit. Anything returned or yielded from the function is passed back to the channel it was called from. If you want to have pmxbot perform an action, just return text that begins with &#8220;/me.&#8221;</p>
<p>Now let&#8217;s do a short contains example &#8211; simple enough.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>contains<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;sqlonrails&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> yay_sor<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	karmaChange<span style="color: black;">&#40;</span>botbase.<span style="color: black;">logger</span>.<span style="color: black;">db</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'sql on rails'</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
	<span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">&quot;Only 76,417 lines...&quot;</span></pre></td></tr></table></div>

<p>This one has no doc (you can&#8217;t get help on contains ATM) and it&#8217;s pretty simple. That karmaChange line increases the karma of &#8220;sql on rails,&#8221; but we&#8217;re not talking about karma.</p>
<h4>Yahoo</h4>
<p>You&#8217;ll need the BOSS library for this, and you&#8217;ll need to register an API key and put a config file where the library expects it. However it works fine once you do all that.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;yahoo&quot;</span><span style="color: #66cc66;">,</span> aliases<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'y'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Look a phrase up on Yahoo!&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> yahoo<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	<span style="color: #ff7700;font-weight:bold;">from</span> yos.<span style="color: black;">boss</span> <span style="color: #ff7700;font-weight:bold;">import</span> ysearch
	searchres <span style="color: #66cc66;">=</span> ysearch.<span style="color: black;">search</span><span style="color: black;">&#40;</span>rest.<span style="color: black;">strip</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> count<span style="color: #66cc66;">=</span><span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
	hit1 <span style="color: #66cc66;">=</span> searchres<span style="color: black;">&#91;</span><span style="color: #483d8b;">'ysearchresponse'</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'resultset_web'</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
	<span style="color: #ff7700;font-weight:bold;">return</span> hit1<span style="color: black;">&#91;</span><span style="color: #483d8b;">'url'</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<h4>Trac</h4>
<p>This is one of my favorites. We use <a href="http://trac.edgewall.org">Trac</a> internally for ticketing. We have two commands that use the XMLRPC plugin for Trac to make it accessible for pmxbot. The first finds any possible ticket number (eg #12345) and provides a link &#038; ticket summary. Note that we put a hack into the handler registry to make this the first contains command it checks, you could do something similar if you wanted to modify it.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>contains<span style="color: black;">&#40;</span><span style="color: #483d8b;">'#'</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'Prints the ticket URL when you use #1234'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> ticket_link<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	res <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span>
	matches <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">re</span>.<span style="color: black;">finditer</span><span style="color: black;">&#40;</span>r<span style="color: #483d8b;">'#(?P&lt;ticket&gt;<span style="color: #000099; font-weight: bold;">\d</span>{4,5})<span style="color: #000099; font-weight: bold;">\b</span>'</span><span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>
	<span style="color: #ff7700;font-weight:bold;">if</span> matches:
		tracrpc <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">xmlrpclib</span>.<span style="color: black;">Server</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'https://user:pass@trac/xmlrpc'</span><span style="color: black;">&#41;</span>
	<span style="color: #ff7700;font-weight:bold;">for</span> match <span style="color: #ff7700;font-weight:bold;">in</span> matches:
		ticket <span style="color: #66cc66;">=</span> match.<span style="color: black;">groupdict</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'ticket'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: black;">&#41;</span>
		<span style="color: #ff7700;font-weight:bold;">if</span> ticket:
			res.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'https://trac/ticket/%s'</span> % ticket<span style="color: black;">&#41;</span>
			<span style="color: #ff7700;font-weight:bold;">try</span>:
				res.<span style="color: black;">append</span><span style="color: black;">&#40;</span>tracrpc.<span style="color: black;">ticket</span>.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #008000;">int</span><span style="color: black;">&#40;</span>ticket<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'summary'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>
			<span style="color: #ff7700;font-weight:bold;">except</span>:
				<span style="color: #ff7700;font-weight:bold;">pass</span>
	<span style="color: #ff7700;font-weight:bold;">if</span> res:
		<span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">' '</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span>res<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>The second uses the RPC to search trac for a ticket or wikipage that might be relevant.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;tsearch&quot;</span><span style="color: #66cc66;">,</span> aliases<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'tracsearch'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Search trac for something&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> tsearch<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	rest <span style="color: #66cc66;">=</span> rest.<span style="color: black;">strip</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
	url <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'https://trac/search?'</span> + <span style="color: #dc143c;">urllib</span>.<span style="color: black;">urlencode</span><span style="color: black;">&#40;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">'q'</span> : rest<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span>
	tracrpc <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">xmlrpclib</span>.<span style="color: black;">Server</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'https://user:pass@trac/xmlrpc'</span><span style="color: black;">&#41;</span>
	searchres <span style="color: #66cc66;">=</span> tracrpc.<span style="color: black;">search</span>.<span style="color: black;">performSearch</span><span style="color: black;">&#40;</span>rest<span style="color: black;">&#41;</span>
	<span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">'%s |Results: %s'</span> % <span style="color: black;">&#40;</span>url<span style="color: #66cc66;">,</span> <span style="color: #483d8b;">' | '</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'%s %s'</span> % <span style="color: black;">&#40;</span>x<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> plaintext<span style="color: black;">&#40;</span>x<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">for</span> x <span style="color: #ff7700;font-weight:bold;">in</span> searchres<span style="color: black;">&#91;</span>:<span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<h4>Notify</h4>
<p>This one is a total hack, but we were having issues with coordinating a certain team. We added a !notify command to help folks easily let everyone, online &#038; off, know what they were up to. It simple sent an email to a distribution list.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;notify&quot;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Send an email to list@domain.com, let them know you accidentally wiped a server.&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> notify<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	server <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">smtplib</span>.<span style="color: black;">SMTP</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'mail.domain.com'</span><span style="color: black;">&#41;</span>
	notification <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'%s: %s'</span> % <span style="color: black;">&#40;</span>nick<span style="color: #66cc66;">,</span> rest.<span style="color: black;">strip</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
	<span style="color: #ff7700;font-weight:bold;">try</span>:
		sigraw <span style="color: #66cc66;">=</span> rand_bot<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'!notify'</span><span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>
		<span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>sigraw<span style="color: black;">&#41;</span> <span style="color: #66cc66;">==</span> GeneratorType:
			sigraw <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span>sigraw<span style="color: black;">&#41;</span>
		signature <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>--<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>%s'</span> % sigraw
	<span style="color: #ff7700;font-weight:bold;">except</span>:
		signature <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>
	msg <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'From: pmxbot@domain.com <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
		<span style="color: #483d8b;">'Reply-To: list@domain.com <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
		<span style="color: #483d8b;">'To: list@domain.com <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
		<span style="color: #483d8b;">'Subject: !notify: %s <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
		<span style="color: #483d8b;">'%s <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
		<span style="color: #483d8b;">'Hugs &amp; Kisses,<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>pmxbot'</span>\
		<span style="color: #483d8b;">'%s<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span> % <span style="color: black;">&#40;</span>notification<span style="color: #66cc66;">,</span> notification<span style="color: #66cc66;">,</span> signature<span style="color: black;">&#41;</span>
	server.<span style="color: black;">sendmail</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'pmxbot@domain.com'</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'list@domain.com'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> msg<span style="color: black;">&#41;</span>
	server.<span style="color: black;">quit</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<h4>Invite</h4>
<p>This one is a little weird, but as more people got on IRC we wanted to send them a little email to let them know how to access it, etc. It&#8217;s also useful to harass people who aren&#8217;t online, but should be.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>command<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;invite&quot;</span><span style="color: #66cc66;">,</span> aliases<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'spam'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> doc<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Send an email to an invitee, asking them to join irc.&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> invite<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	server <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">smtplib</span>.<span style="color: black;">SMTP</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'mail.domain.com'</span><span style="color: black;">&#41;</span>
	<span style="color: #ff7700;font-weight:bold;">if</span> rest:
		<span style="color: #ff7700;font-weight:bold;">try</span>:
			inviteText <span style="color: #66cc66;">=</span> rest.<span style="color: black;">split</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">' '</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>
		<span style="color: #ff7700;font-weight:bold;">except</span>:
			inviteText <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>
		invitee <span style="color: #66cc66;">=</span> rest.<span style="color: black;">split</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">' '</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> + <span style="color: #483d8b;">'@domain.com'</span>
		<span style="color: #ff7700;font-weight:bold;">try</span>:
			sigraw <span style="color: #66cc66;">=</span> rand_bot<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'!notify'</span><span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>
			<span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>sigraw<span style="color: black;">&#41;</span> <span style="color: #66cc66;">==</span> GeneratorType:
				sigraw <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span>sigraw<span style="color: black;">&#41;</span>
			signature <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>--<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>%s'</span> % sigraw
		<span style="color: #ff7700;font-weight:bold;">except</span>:
			signature <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>
		msg <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'From: pmxbot@domain.com <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
			<span style="color: #483d8b;">'Reply-To: noreply@domain.com <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
			<span style="color: #483d8b;">'To: %s <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
			<span style="color: #483d8b;">'Subject: join us in irc! <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
			<span style="color: #483d8b;">'%s <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>Remember, you can find about irc here: https://intranet/IRC<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
			<span style="color: #483d8b;">'You can access IRC via your web browser at https://domain.com/irc <span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>\
			<span style="color: #483d8b;">'Hugs &amp; Kisses,<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>%s &amp; pmxbot'</span>\
			<span style="color: #483d8b;">'%s<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span> % <span style="color: black;">&#40;</span>invitee<span style="color: #66cc66;">,</span> inviteText<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> signature<span style="color: black;">&#41;</span>
		server.<span style="color: black;">sendmail</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'pmxbot@domain.com'</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span>invitee<span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> msg<span style="color: black;">&#41;</span>
		server.<span style="color: black;">quit</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<h4>Personal Responses</h4>
<p>We have a ton of these, this is just one example. They watch for people being referenced, and occasionally (the randomness is key for many of them, to keep from being obnoxious) respond.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>contains<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;elarson&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> elarsonthemachine<span style="color: black;">&#40;</span>client<span style="color: #66cc66;">,</span> event<span style="color: #66cc66;">,</span> channel<span style="color: #66cc66;">,</span> nick<span style="color: #66cc66;">,</span> rest<span style="color: black;">&#41;</span>:
	<span style="color: #ff7700;font-weight:bold;">if</span> nick <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'elarson'</span> <span style="color: #ff7700;font-weight:bold;">and</span> <span style="color: #483d8b;">'http://'</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> rest <span style="color: #ff7700;font-weight:bold;">and</span> <span style="color: #483d8b;">'https://'</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> rest:
		<span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">'elarson - The Machine!!!'</span></pre></td></tr></table></div>

<h4>Other RPCs</h4>
<p>I won&#8217;t show you the code, because removing the specific stuff would make it boring. But we have about a half dozen internal RPCs we can call with it. Some use Pyro, others XMLRPC. That trac search example is pretty representative. </p>
<h4>RSS/Atom</h4>
<p>We have pmxbot monitoring about a half dozen RSS feeds. The intranet and dev site both have them, we monitor twitter search for a bunch of keywords, as well as google news. It&#8217;s a pretty sweet feature, if you ask me.</p>
<p>In conclusion, pmxbot is awesome. I&#8217;d like to make it even easier for people to add their own features. Maybe include a setting in the YAML conf file that&#8217;s a python file which is imported? What else do you have (all zero of you using pmxbot)?</p>
			<a href="../../../../2010/04/custom-pmxbot-actions/index.html#comments">3 Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../2010/03/picloud-followup-bumpy-road/index.html">PiCloud followup&#8230; bumpy road</a></h1>
			<small><b>Posted:</b> March 12th, 2010 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/data/index.html" rel="tag">data</a>, <a href="../../../../tag/picloud/index.html" rel="tag">picloud</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a> | <a href="../../../../2010/03/picloud-followup-bumpy-road/index.html#comments">2 Comments &#187;</a></small>
			<p>I had to crunch some data today, and decided to experiment a bit. It mostly involved lots and lots of Levenshtein ratios. On my laptop it took over 25 minutes to complete a single run (45k rows, several thousand calculations per row) &#8211; a bummer when you want to quickly iterate the rules, cutoffs, penalties, etc. First step was simply cutting out some work that was a nice-to-have. That got me down to 16 minutes.</p>
<p>Second was adding multiprocessing. I figured this would be easy, but the way I originally wrote the code (the function required both an element, and a penalty matrix) meant that just plain multiprocessing.Pool.map() wasn&#8217;t working. I wrapped it up with itertools.izip(iterator, itertools.repeat(matrix)), but that gives a tuple which you can&#8217;t easily export. It turns out that this, basically <a href="http://docs.python.org/library/multiprocessing.html#examples">calculatorstar</a> from the Pool example, is a godsend:</p>
<pre>def wrapper(args):
    return func(*args)
</pre>
<p>So that got me down to 8 minutes on my laptop. However the cool part is that on an 8 core server I was down to only 1 minute, 30 seconds. Those are the sorts of iteration times I can deal with.</p>
<p>Then I decided to try the <a href="http://picloud.com">PiCloud</a>. After <a href="http://chmullig.com/category/nerdery/page/2/2010/03/picloud-introduction">trying it out </a>earlier this week I thought it would be interesting to test it on a real problem that linearly scales with more cores.  They advertise it in the docs, so I figured maybe it would be useful and even faster. Not so fast. It was easy to write after I already had multiprocessing working, but the first version literally crashed my laptop. I later figured out that the &#8220;naive&#8221; way to write it made it suck up all the RAM on the system. After less than 5 minutes I killed it with 1.7GB/2GB consumed. Running it on the aforementioned 8 core/32GB server had it consume 5GB before it finally crashed with a HTTP 500 error. I <a href="http://support.picloud.com/entries/126939-cloud-map-using-huge-amounts-of-memory-failing">posted</a> in the forums, got some advice, but still can&#8217;t get it working. (Read that short thread for the rest of the story). This seems like exactly what they should be nailing, but so far they&#8217;re coming up empty.</p>
			<a href="../../../../2010/03/picloud-followup-bumpy-road/index.html#comments">2 Comments &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
				
		<div class="post">
			<h1><a href="../../../../author/chmullig/page/5/2010/03/picloud-introduction">PiCloud introduction</a></h1>
			<small><b>Posted:</b> March 9th, 2010 | <b>Author:</b> <a href="../../../../author/chmullig/index.html" title="Posts by chmullig" rel="author">chmullig</a> | <b>Filed under:</b> <a href="../../index.html" rel="category tag">Nerdery</a>  | <b>Tags:</b> <a href="../../../../tag/distributed/index.html" rel="tag">distributed</a>, <a href="../../../../tag/picloud/index.html" rel="tag">picloud</a>, <a href="../../../../tag/pyro/index.html" rel="tag">pyro</a>, <a href="../../../../tag/python/index.html" rel="tag">python</a> | <a href="../../../../author/chmullig/page/5/2010/03/picloud-introduction#comments">1 Comment &#187;</a></small>
			<p>A couple weeks ago my <a title="ionrock/Eric Larson" href="http://ionrock.org/">coworker</a> <a title="@ionrock: Interesting distributed processing library " href="http://twitter.com/ionrock/status/9695304551">mentioned</a> <a title="PiCloud | Cloud Computing. Simplified." href="http://www.picloud.com/">PiCloud</a>. It claims to be &#8220;Cloud Computing. Simplified.&#8221; for python programming. Indeed, their trivial examples are too good to be true, basically. I pointed out how the way it was packaging up code to send over the wire was a lot like <a title="Pyro - PYthon Remote Objects" href="http://pyro.sourceforge.net/">Pyro</a>&#8216;s <a href="http://pyro.sourceforge.net/manual/7-features.html#mobile">Mobile Code</a> feature. We actually use Pyro mobile code quite a bit at work, within the context of our own distributed system running across machines we maintain.</p>
<p>After getting beta access I decided to check it out today. I spent about 15 minutes playing around with it, and decided to do a short writeup because there&#8217;s so little info out there. The short version is that technically it&#8217;s quite impressive. Simple, but more complicated than <tt>square(x)</tt> cases are as easy as they say. Information about PiCloud is in pretty short supply, so here&#8217;s my playing around reproduced for all to see.</p>
<h3>Installing/first using</h3>
<p>This is pretty easy. I&#8217;m using a virtualenv because I was skeptical, but it&#8217;s neat how easy it is even with that. So I&#8217;m going to setup a virtualenv, install ipython to the virtualenv, then install the cloud egg. At the end I&#8217;ll add my api key to the ~/.picloud/cloudconf.py file so I don&#8217;t need to type it repeatedly. The file is created when you first import cloud, and is very straightforward.</p>
<pre>chmullig@gore:~$ virtualenv picloud
New python executable in picloud/bin/python
Installing setuptools............done.
chmullig@gore:~$ source picloud/bin/activate
(picloud)chmullig@gore:~$ easy_install -U ipython
Searching for ipython
#snip
Processing ipython-0.10-py2.6.egg
creating /home/chmullig/picloud/lib/python2.6/site-packages/ipython-0.10-py2.6.egg
Extracting ipython-0.10-py2.6.egg to /home/chmullig/picloud/lib/python2.6/site-packages
Adding ipython 0.10 to easy-install.pth file
Installing iptest script to /home/chmullig/picloud/bin
Installing ipythonx script to /home/chmullig/picloud/bin
Installing ipcluster script to /home/chmullig/picloud/bin
Installing ipython script to /home/chmullig/picloud/bin
Installing pycolor script to /home/chmullig/picloud/bin
Installing ipcontroller script to /home/chmullig/picloud/bin
Installing ipengine script to /home/chmullig/picloud/bin

Installed /home/chmullig/picloud/lib/python2.6/site-packages/ipython-0.10-py2.6.egg
Processing dependencies for ipython
Finished processing dependencies for ipython
(picloud)chmullig@gore:~$ easy_install http://server/cloud-1.8.2-py2.6.egg
Downloading http://server/cloud-1.8.2-py2.6.egg
Processing cloud-1.8.2-py2.6.egg
creating /home/chmullig/picloud/lib/python2.6/site-packages/cloud-1.8.2-py2.6.egg
Extracting cloud-1.8.2-py2.6.egg to /home/chmullig/picloud/lib/python2.6/site-packages
Adding cloud 1.8.2 to easy-install.pth file

Installed /home/chmullig/picloud/lib/python2.6/site-packages/cloud-1.8.2-py2.6.egg
Processing dependencies for cloud==1.8.2
Finished processing dependencies for cloud==1.8.2
(picloud)chmullig@gore:~$ python -c 'import cloud' #to create the ~/.picloud directory
(picloud)chmullig@gore:~$ vim .picloud/cloudconf.py #to add api_key and api_secretkey
</pre>
<h3>Trivial Examples</h3>
<p>This is their trivial example, just to prove it&#8217;s as easy for me as it was for them.</p>
<pre>In [1]: def square(x):
 ...:     return x**2
 ...:
In [2]: import cloud
In [3]: cid = cloud.call(square, 10)
In [4]: cloud.result(cid)
Out[4]: 100
</pre>
<p>BAM! That&#8217;s just stupidly easy. Let&#8217;s try a module or two.</p>
<pre>In [5]: import random
In [6]: def shuffler(x):
 ...:     xl = list(x)
 ...:     random.shuffle(xl)
 ...:     return ''.join(xl)
 ...:
In [8]: cid = cloud.call(shuffler, 'Welcome to chmullig.com')
In [9]: cloud.result(cid)
Out[9]: ' etcmmhmoeWll.cgcl uioo'
</pre>
<h3>Less-Trivial Example &amp; Packages</h3>
<p>So that&#8217;s neat, but what about something I wrote, or something that&#8217;s off <a href="http://pypi.python.org/pypi">pypi</a> that they don&#8217;t already have installed? Also quite easy. I&#8217;m going to be using  <a title="Levenshtein distance - Wikipedia" href="http://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein edit distance</a> for this, because it&#8217;s simple but non-standard. For our purposes we&#8217;ll begin with a <a href="http://hetland.org/coding/python/levenshtein.py">pure python implementation</a>, borrowed from <a href="http://hetland.org/coding/">Magnus Lie</a>. Then we&#8217;ll switch to a C extension version, originally written by David Necas (Yeti), which I&#8217;ve <a href="http://code.google.com/p/pylevenshtein/">rehosted</a> on Google Code.</p>
<pre>(picloud)chmullig@gore:~$ wget -O hetlev.py http://hetland.org/coding/python/levenshtein.py
#snip
2010-03-09 12:13:04 (79.2 KB/s) - `hetlev.py' saved [707/707]
(picloud)chmullig@gore:~$ easy_install http://pylevenshtein.googlecode.com/files/python-Levenshtein-0.10.1.tar.bz2
Downloading http://pylevenshtein.googlecode.com/files/python-Levenshtein-0.10.1.tar.bz2
Processing python-Levenshtein-0.10.1.tar.bz2
Running python-Levenshtein-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-mqtK2d/python-Levenshtein-0.10.1/egg-dist-tmp-igxMyM
zip_safe flag not set; analyzing archive contents...
Adding python-Levenshtein 0.10.1 to easy-install.pth file

Installed /home/chmullig/picloud/lib/python2.6/site-packages/python_Levenshtein-0.10.1-py2.6-linux-x86_64.egg
Processing dependencies for python-Levenshtein==0.10.1
Finished processing dependencies for python-Levenshtein==0.10.1
(picloud)chmullig@gore:~$
</pre>
<p>Now both are installed locally and built. Beautiful. Let&#8217;s go ahead and test out the hetlev version.</p>
<pre>In [18]: def distances(word, comparisonWords):
 ....:     results = []
 ....:     for otherWord in comparisonWords:
 ....:         results.append(hetlev.levenshtein(word, otherWord))
 ....:     return results
In [24]: zip(words, distances(word, words))
Out[24]:
[('kitten', 0),
 ('sitten', 1),
 ('sittin', 2),
 ('sitting', 3),
 ('cat', 5),
 ('kitty', 2),
 ('smitten', 2)]
</pre>
<p>Now let&#8217;s put that up on PiCloud! It&#8217;s, uh, trivial. And fast.</p>
<pre>In [25]: cid = cloud.call(distances, word, words)
In [26]: zip(words, cloud.result(cid))
Out[26]:
[('kitten', 0),
 ('sitten', 1),
 ('sittin', 2),
 ('sitting', 3),
 ('cat', 5),
 ('kitty', 2),
 ('smitten', 2)]
</pre>
<p>Now let&#8217;s switch it to use the <strong>C extension version</strong> of edit distance from the PyLevenshtein package, and try to use it with PiCloud.</p>
<pre>In [32]: import Levenshtein
In [33]: def cdistances(word, comparisonWords):
 results = []
 for otherword in comparisonWords:
 results.append(Levenshtein.distance(word, otherword))
 return results
 ....:
In [38]: zip(words, cdistances(word, words))
Out[38]:
[('kitten', 0),
 ('sitten', 1),
 ('sittin', 2),
 ('sitting', 3),
 ('cat', 5),
 ('kitty', 2),
 ('smitten', 2)]

In [39]: cid = cloud.call(cdistances, word, words)
In [40]: cloud.result(cid)
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (30, 0))

ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (37, 0))
---------------------------------------------------------------------------
CloudException                            Traceback (most recent call last)
CloudException: Job 14:
 Could not depickle job
Traceback (most recent call last):
 File "/root/.local/lib/python2.6/site-packages/cloudserver/workers/employee/child.py", line 202, in run
 File "/usr/local/lib/python2.6/dist-packages/cloud/serialization/cloudpickle.py", line 501, in subimport
 __import__(name)
ImportError: ('No module named Levenshtein', &lt;function subimport at 0x2290ed8&gt;, ('Levenshtein',))
</pre>
<h3>Installing C-Extension via web</h3>
<p><a href="../../../../wp-content/uploads/2010/03/picloud-repo.png"><img class="alignright size-medium wp-image-74" title="picloud repo" src="../../../../wp-content/uploads/2010/03/picloud-repo-300x175.png" alt="" width="300" height="175" /></a>Not too surprisingly that didn&#8217;t work &#8211; Levenshtein is a C extension I built on my local machine. PiCloud doesn&#8217;t really make it obvious, but you can add C-Extensions via their <a href="http://www.picloud.com/accounts/packages/">web interface</a>. Amazingly you can point it to an SVN repo and it will let you refresh it. It seems to download and call setup.py install, but it&#8217;s a little unclear. The fact is it just worked, so I didn&#8217;t care. I clicked on &#8220;Add Repository&#8221; and pasted in the URL from google code,  <tt>http://pylevenshtein.googlecode.com/svn/trunk</tt>. It built it and installed it, you can see the output on the right. I then just reran the exact same command and it works.</p>
<pre style="clear: both;">In [41]: cid = cloud.call(cdistances, word, words)

In [42]: cloud.result(cid)
Out[42]: [0, 1, 2, 3, 5, 2, 2]

In [43]: zip(words, cloud.result(cid))
Out[43]:
[('kitten', 0),
 ('sitten', 1),
 ('sittin', 2),
 ('sitting', 3),
 ('cat', 5),
 ('kitty', 2),
 ('smitten', 2)]
</pre>
<h3>Slightly more complicated</h3>
<p>I&#8217;ve written a slightly more complicated script that fetches the <a href="http://www.qwantz.com/index.php?comic=1665">qwantzle</a> <a href="http://cs.brown.edu/~jadrian/docs/etc/qwantzcorpus">corpus</a> and uses <a title="Jaro-Winkler distance" href="http://en.wikipedia.org/wiki/Jaro-Winkler_distance">jaro</a> distance to find the n closest words in the corpus to a given word. It&#8217;s pretty trivial and dumb, but definitely more complicated than the above examples. Below is closestwords.py</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> Levenshtein
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">urllib</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> Corpusinator<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">'''
        Finds the closest words to the word you specified.
        '''</span>
        <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> corpus<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'http://cs.brown.edu/~jadrian/docs/etc/qwantzcorpus'</span><span style="color: black;">&#41;</span>:
                <span style="color: #483d8b;">'''Setup the corpus for later use. By default it uses
                http://cs.brown.edu/~jadrian/docs/etc/qwantzcorpus, but can by overridden
                by specifying an alternate URL that has one word per line. A number, a space, then the word.
                '''</span>
                raw <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">urllib</span>.<span style="color: black;">urlopen</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'http://cs.brown.edu/~jadrian/docs/etc/qwantzcorpus'</span><span style="color: black;">&#41;</span>.<span style="color: black;">readlines</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
                <span style="color: #008000;">self</span>.<span style="color: black;">corpus</span> <span style="color: #66cc66;">=</span> <span style="color: #008000;">set</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">for</span> line <span style="color: #ff7700;font-weight:bold;">in</span> raw:
                        <span style="color: #ff7700;font-weight:bold;">try</span>:
                                <span style="color: #008000;">self</span>.<span style="color: black;">corpus</span>.<span style="color: black;">add</span><span style="color: black;">&#40;</span>line.<span style="color: black;">split</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>
                        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">IndexError</span>:
                                <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">def</span> findClosestWords<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> words<span style="color: #66cc66;">,</span> n<span style="color: #66cc66;">=</span><span style="color: #ff4500;">10</span><span style="color: black;">&#41;</span>:
                <span style="color: #483d8b;">'''
                Return the n (default 10) closest words from the corpus.
                '''</span>
                results <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>
                <span style="color: #ff7700;font-weight:bold;">for</span> word <span style="color: #ff7700;font-weight:bold;">in</span> words:
                        tempresults <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span>
                        <span style="color: #ff7700;font-weight:bold;">for</span> refword <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">self</span>.<span style="color: black;">corpus</span>:
                                dist <span style="color: #66cc66;">=</span> Levenshtein.<span style="color: black;">jaro</span><span style="color: black;">&#40;</span>word<span style="color: #66cc66;">,</span> refword<span style="color: black;">&#41;</span>
                                tempresults.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>dist<span style="color: #66cc66;">,</span> refword<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
                        tempresults <span style="color: #66cc66;">=</span> <span style="color: #008000;">sorted</span><span style="color: black;">&#40;</span>tempresults<span style="color: #66cc66;">,</span> reverse<span style="color: #66cc66;">=</span><span style="color: #008000;">True</span><span style="color: black;">&#41;</span>
                        results<span style="color: black;">&#91;</span>word<span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> tempresults<span style="color: black;">&#91;</span>:n<span style="color: black;">&#93;</span>
                <span style="color: #ff7700;font-weight:bold;">return</span> results</pre></td></tr></table></div>

<p>Very simple. Let&#8217;s try &#8216;er out. First locally, then over the cloud.</p>
<pre>In [1]: import closestwords

In [2]: c = closestwords.Corpusinator()

In [3]: c.findClosestWords(['bagel', 'cheese'], 5)
Out[3]:
{'bagel': [(0.8666666666666667, 'barge'),
           (0.8666666666666667, 'bag'),
           (0.8666666666666667, 'badge'),
           (0.8666666666666667, 'angel'),
           (0.8666666666666667, 'age')],
 'cheese': [(1.0, 'cheese'),
            (0.95238095238095244, 'cheesed'),
            (0.88888888888888895, 'cheers'),
            (0.88888888888888895, 'cheeks'),
            (0.8666666666666667, 'cheeseball')]}
</pre>
<p>Unfortunately it just doesn&#8217;t want to work happily with PiCloud &amp; ipython when you&#8217;re running <tt>import closestwords</tt>. The most obvious won&#8217;t work, cloud.call(c.findClosestWords, [&#8216;bagel&#8217;]). Neither will creating a tiny wrapper function and calling that within ipython:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> caller<span style="color: black;">&#40;</span>words<span style="color: #66cc66;">,</span> n<span style="color: #66cc66;">=</span><span style="color: #ff4500;">10</span><span style="color: black;">&#41;</span>:
    c <span style="color: #66cc66;">=</span> closestwords.<span style="color: black;">Corpusinator</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> c.<span style="color: black;">findClosestWords</span><span style="color: black;">&#40;</span>words<span style="color: #66cc66;">,</span> n<span style="color: black;">&#41;</span>
cloud.<span style="color: black;">call</span><span style="color: black;">&#40;</span>caller<span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'bagel'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>I created a stupidly simple wrapper python file, wrap.py:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> closestwords
<span style="color: #ff7700;font-weight:bold;">import</span> cloud
cid <span style="color: #66cc66;">=</span> cloud.<span style="color: black;">call</span><span style="color: black;">&#40;</span>closestwords.<span style="color: black;">caller</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'bagel'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">print</span> cloud.<span style="color: black;">result</span><span style="color: black;">&#40;</span>cid<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>That gives an import error. Even putting that caller wrapper above at the bottom of the closestwords.py and calling it in the __main__ section (as I do below with c.findClosestWords) didn&#8217;t work.</p>
<p>However if I stick it directly in closestwords.py, initialize the instance, then run it from there, everything is fine. I&#8217;m not sure what this means, if it&#8217;s supposed to happen, or what. But it seems like it could be a pain in the butt just to get  it calling the right function in the right context.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">if</span> __name__ <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'__main__'</span>:
        <span style="color: #ff7700;font-weight:bold;">import</span> cloud
        c <span style="color: #66cc66;">=</span> Corpusinator<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        cid <span style="color: #66cc66;">=</span> cloud.<span style="color: black;">call</span><span style="color: black;">&#40;</span>c.<span style="color: black;">findClosestWords</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'bagel'</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">print</span> cloud.<span style="color: black;">result</span><span style="color: black;">&#40;</span>cid<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<h3>What passes for a conclusion</h3>
<p>I had a good time playing with PiCloud. I&#8217;m going to look at adapting real code to use it. If I get carried away AND feel like blogging I&#8217;ll be sure to post &#8216;er up. They have pretty good first tier support for the map part of map/reduce, which would be useful. Two links I found useful when working with PiCloud:</p>
<ul>
<li><a href="http://docs.picloud.com/index.html">PiCloud Documentation</a></li>
<li><a href="http://www.picloud.com/pyapi/packages/weblist/python/">The list of installed packages</a></li>
<li><a href="http://support.picloud.com/forums">PiCloud Forums</a></li>
<li>The <a href="http://docs.picloud.com/basic_examples.html">Web Scraper </a>example in their docs</li>
</ul>
<hr />
<h3>Update 3/11</h3>
<p>Aaron Staley of PiCloud wrote me a nice email about this post. He says my problem with the closestwords example was due to a server side bug they&#8217;ve fixed. In playing around, it does seem a bit better. A few ways I tried to call it failed, but many of them worked. I had trouble passing in closestwords.caller, either in ipython or the wrapper script. However re-defining caller in ipython worked, as did creating an instance and passing in the instance&#8217;s findClosestWords function. A+ for communication, guys.</p>
<pre>In [3]: cid = cloud.call(closestwords.caller, ['bagel'])

In [4]: cloud.result(cid)
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (30, 0))

ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (37, 0))
---------------------------------------------------------------------------CloudException: Job 36: Could not depickle job
Traceback (most recent call last):
 File "/root/.local/lib/python2.6/site-packages/cloudserver/workers/employee/child.py", line 202, in run
AttributeError: 'module' object has no attribute 'caller'

In [8]: c = closestwords.Corpusinator()
In [9]: cid = cloud.call(c.findClosestWords, ['bagel', 'cheese'], 5)
In [10]: cloud.result(cid)
Out[10]:
{'bagel': [(0.8666666666666667, 'barge'),
 (0.8666666666666667, 'bag'),
 (0.8666666666666667, 'badge'),
 (0.8666666666666667, 'angel'),
 (0.8666666666666667, 'age')],
 'cheese': [(1.0, 'cheese'),
 (0.95238095238095244, 'cheesed'),
 (0.88888888888888895, 'cheers'),
 (0.88888888888888895, 'cheeks'),
 (0.8666666666666667, 'cheeseball')]}

In [11]: def caller(words, n=10):
 ....:     c = closestwords.Corpusinator()
 ....:     return c.findClosestWords(words, n)
 ....:
In [12]: cid = cloud.call(caller, ['bagel'])
In [13]: reload(closestword)
KeyboardInterrupt
In [13]: cloud.result(cid)
Out[13]:
{'bagel': [(0.8666666666666667, 'barge'),
 (0.8666666666666667, 'bag'),
 (0.8666666666666667, 'badge'),
 (0.8666666666666667, 'angel'),
 (0.8666666666666667, 'age'),
 (0.8222222222222223, 'barrel'),
 (0.8222222222222223, 'barely'),
 (0.81111111111111123, 'gamble'),
 (0.79047619047619044, 'vaguely'),
 (0.79047619047619044, 'largely')]}
</pre>
<h3>Update 3/12</h3>
<p>I did some more experimentation with PiCloud, <a title="PiCloud - Following the bumpy road" href="../../../../2010/03/picloud-followup-bumpy-road/index.html">posted separately</a>.</p>
			<a href="../../../../author/chmullig/page/5/2010/03/picloud-introduction#comments">1 Comment &#187;</a>			 <hr/>
		</div>
		<a name="respond"/>
				
		
		<div class="navigation">
			<div class="alignleft"><a href="../3/index.html" >&laquo; Older Entries</a></div>
			<div class="alignright"><a href="../../index.html" >Newer Entries &raquo;</a></div>
		</div>

	
	</div>
	
	<div id="sidebar">
	<div class="block text-3 widget_text"><h3>Twitter</h3>			<div class="textwidget"><script src="http://widgets.twimg.com/j/2/widget.js"></script>
<script>
new TWTR.Widget({
  version: 2,
  type: 'profile',
  rpp: 7,
  interval: 6000,
  width: 'auto',
  height: 300,
  theme: {
    shell: {
      background: '#5698CC',
      color: '#396799'
    },
    tweets: {
      background: '#C8D7E1',
      color: '#396799',
      links: '#344593',
    }
  },
  features: {
    scrollbar: false,
    loop: false,
    live: true,
    hashtags: true,
    timestamp: true,
    avatars: false,
    behavior: 'all'
  }
}).render().setUser('chmullig').start();
</script></div>
		</div><div class="block links-3 widget_links"><h3>Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://dowski.com" rel="friend met co-worker colleague" title="Christian, a coworker">dowski</a></li>
<li><a href="http://www.everyguide.org/" rel="friend met co-worker colleague" title="Chris Perry&#8217;s very amusing blog">The Complete Guide to Everything</a></li>
<li><a href="http://jamwt.com" rel="friend met colleague" title="Jamie, a coworker">jamwt</a></li>
<li><a href="http://ionrock.org/blog" rel="friend met co-worker colleague" title="Eric Larson">ionrock</a></li>
<li><a href="http://michael.susens-schurter.com/blog/" rel="friend met" title="Michael Schurter, a former coworker">Michael Schurter</a></li>
<li><a href="http://www.lifeaftercollege.org/" rel="acquaintance met co-worker" title="Life After College, by Jenny Blake  There&#8217;s no manual for the real world. Find tips and resources for life, work, money, happiness, personal growth, productivity, etc">Life After College</a></li>
<li><a href="http://tehallanc.wordpress.com/" rel="friend co-worker colleague" title="Allan, another coworker">allanc</a></li>
<li><a href="http://adventuresinoptimization.blogspot.com/" rel="acquaintance met co-worker colleague" title="Ryan&#8217;s blog about Operations Research, etc">Adventures in Optimization</a></li>
<li><a href="http://seatatthetable.wordpress.com/" rel="friend" title="Lauren&#8217;s delicious food blog">A Seat at the Table</a></li>

	</ul>
</div>
<div class="block links-3 widget_links"><h3>Me, elsewhere</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.linkedin.com/in/chrismulligan" rel="me" title="My profile on LinkedIn">LinkedIn</a></li>
<li><a href="http://bitbucket.org/chmullig" rel="me" title="chmullig@bitbucket.org">BitBucket</a></li>
<li><a href="https://github.com/chmullig" rel="me" title="My github account.">Github</a></li>
<li><a href="http://twitter.com/chmullig" rel="me">Twitter</a></li>
<li><a href="http://facebook.com/chmullig" rel="me" title="Me on Facebook">Facebook</a></li>
<li><a href="http://live.xbox.com/member/Ars%20clm100" rel="me" title="I&#8217;m &#8220;Ars clm100&#8243; on xbox live">xbox live</a></li>
<li><a href="http://us.playstation.com/playstation/psn/visit/profiles/chmullig" rel="me" title="I&#8217;m &#8220;chmullig&#8221; on the Playstation Network">PSN</a></li>
<li><a href="http://stackoverflow.com/users/349931/chmullig" rel="me" title="Programming Q&amp;A site">stackoveflow</a></li>

	</ul>
</div>
<div class="block blog_subscription-2 jetpack_subscription_widget"><h3><label for="subscribe-field">Subscribe to Blog via Email</label></h3>
		<form action="index.html#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
			<p id="subscribe-text">Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
			<p id="subscribe-email"><input type="text" name="email" value="Email Address" id="subscribe-field" onclick="if ( this.value == 'Email Address' ) { this.value = ''; }" onblur="if ( this.value == '' ) { this.value = 'Email Address'; }" /></p>

			<p id="subscribe-submit">
				<input type="hidden" name="action" value="subscribe" />
				<input type="hidden" name="source" value="http://chmullig.com/category/nerdery/page/2/" />
				<input type="hidden" name="sub-type" value="widget" />
				<input type="hidden" name="redirect_fragment" value="blog_subscription-2" />
								<input type="submit" value="Subscribe" name="jetpack_subscriptions_widget" />
			</p>
		</form>

		
</div><div class="block tag_cloud-3 widget_tag_cloud"><h3>Tags</h3><div class="tagcloud"><a href='../../../../tag/apple/index.html' class='tag-link-27' title='2 topics' style='font-size: 10.964705882353pt;'>apple</a>
<a href='../../../../tag/armchair-pundit/index.html' class='tag-link-28' title='1 topic' style='font-size: 8pt;'>armchair pundit</a>
<a href='../../../../tag/ascii/index.html' class='tag-link-9' title='1 topic' style='font-size: 8pt;'>ascii</a>
<a href='../../../../tag/bluelounge/index.html' class='tag-link-43' title='1 topic' style='font-size: 8pt;'>bluelounge</a>
<a href='../../../../tag/bnc/index.html' class='tag-link-11' title='1 topic' style='font-size: 8pt;'>BNC</a>
<a href='../../../../tag/burrito/index.html' class='tag-link-32' title='9 topics' style='font-size: 19.529411764706pt;'>burrito</a>
<a href='../../../../tag/burrito-wednesday/index.html' class='tag-link-35' title='8 topics' style='font-size: 18.705882352941pt;'>burrito wednesday</a>
<a href='../../../../tag/burritoweds/index.html' class='tag-link-34' title='1 topic' style='font-size: 8pt;'>burritoweds</a>
<a href='../../../../tag/burrito-wedsneday/index.html' class='tag-link-31' title='1 topic' style='font-size: 8pt;'>burrito wedsneday</a>
<a href='../../../../tag/chipotle/index.html' class='tag-link-33' title='1 topic' style='font-size: 8pt;'>chipotle</a>
<a href='../../../../tag/columbia/index.html' class='tag-link-96' title='6 topics' style='font-size: 17.058823529412pt;'>Columbia</a>
<a href='../../../../tag/cooking/index.html' class='tag-link-14' title='1 topic' style='font-size: 8pt;'>cooking</a>
<a href='../../../../tag/data/index.html' class='tag-link-18' title='4 topics' style='font-size: 14.588235294118pt;'>data</a>
<a href='../../../../tag/data-science/index.html' class='tag-link-107' title='2 topics' style='font-size: 10.964705882353pt;'>data science</a>
<a href='../../../../tag/desk/index.html' class='tag-link-38' title='1 topic' style='font-size: 8pt;'>desk</a>
<a href='../../../../tag/distributed/index.html' class='tag-link-15' title='1 topic' style='font-size: 8pt;'>distributed</a>
<a href='../../../../tag/facebook/index.html' class='tag-link-26' title='2 topics' style='font-size: 10.964705882353pt;'>facebook</a>
<a href='../../../../tag/fishboy/index.html' class='tag-link-13' title='1 topic' style='font-size: 8pt;'>fishboy</a>
<a href='../../../../tag/graphing/index.html' class='tag-link-69' title='2 topics' style='font-size: 10.964705882353pt;'>graphing</a>
<a href='../../../../tag/high-school/index.html' class='tag-link-12' title='1 topic' style='font-size: 8pt;'>high school</a>
<a href='../../../../tag/history/index.html' class='tag-link-66' title='2 topics' style='font-size: 10.964705882353pt;'>history</a>
<a href='../../../../tag/irc/index.html' class='tag-link-21' title='1 topic' style='font-size: 8pt;'>irc</a>
<a href='../../../../tag/kaggle/index.html' class='tag-link-108' title='2 topics' style='font-size: 10.964705882353pt;'>kaggle</a>
<a href='../../../../tag/library-paste/index.html' class='tag-link-25' title='1 topic' style='font-size: 8pt;'>library paste</a>
<a href='../../../../tag/office/index.html' class='tag-link-40' title='1 topic' style='font-size: 8pt;'>office</a>
<a href='../../../../tag/paste/index.html' class='tag-link-24' title='1 topic' style='font-size: 8pt;'>paste</a>
<a href='../../../../tag/personal/index.html' class='tag-link-23' title='1 topic' style='font-size: 8pt;'>personal</a>
<a href='../../../../tag/picloud/index.html' class='tag-link-17' title='2 topics' style='font-size: 10.964705882353pt;'>picloud</a>
<a href='../../../../tag/pmxbot/index.html' class='tag-link-20' title='3 topics' style='font-size: 12.941176470588pt;'>pmxbot</a>
<a href='../../../../tag/programming/index.html' class='tag-link-49' title='6 topics' style='font-size: 17.058823529412pt;'>programming</a>
<a href='../../../../tag/pyro/index.html' class='tag-link-16' title='1 topic' style='font-size: 8pt;'>pyro</a>
<a href='../../../../tag/python/index.html' class='tag-link-6' title='13 topics' style='font-size: 22pt;'>python</a>
<a href='../../../../tag/r/index.html' class='tag-link-48' title='5 topics' style='font-size: 15.905882352941pt;'>r</a>
<a href='../../../../tag/review/index.html' class='tag-link-41' title='1 topic' style='font-size: 8pt;'>review</a>
<a href='../../../../tag/running/index.html' class='tag-link-22' title='1 topic' style='font-size: 8pt;'>running</a>
<a href='../../../../tag/space/index.html' class='tag-link-37' title='1 topic' style='font-size: 8pt;'>space</a>
<a href='../../../../tag/stackoverflow/index.html' class='tag-link-54' title='2 topics' style='font-size: 10.964705882353pt;'>stackoverflow</a>
<a href='../../../../tag/statistics/index.html' class='tag-link-73' title='3 topics' style='font-size: 12.941176470588pt;'>statistics</a>
<a href='../../../../tag/studiodesk/index.html' class='tag-link-42' title='1 topic' style='font-size: 8pt;'>studiodesk</a>
<a href='../../../../tag/studio-desk/index.html' class='tag-link-44' title='1 topic' style='font-size: 8pt;'>studio desk</a>
<a href='../../../../tag/sysadmin/index.html' class='tag-link-7' title='1 topic' style='font-size: 8pt;'>sysadmin</a>
<a href='../../../../tag/trac/index.html' class='tag-link-10' title='1 topic' style='font-size: 8pt;'>trac</a>
<a href='../../../../tag/twitter/index.html' class='tag-link-30' title='1 topic' style='font-size: 8pt;'>twitter</a>
<a href='../../../../tag/unicode/index.html' class='tag-link-8' title='1 topic' style='font-size: 8pt;'>unicode</a>
<a href='../../../../tag/work/index.html' class='tag-link-39' title='2 topics' style='font-size: 10.964705882353pt;'>work</a></div>
</div><div class="block archives-3 widget_archive"><h3>Archives</h3>		<ul>
	<li><a href='../../../../2015/04/index.html'>April 2015</a></li>
	<li><a href='../../../../2015/02/index.html'>February 2015</a></li>
	<li><a href='../../../../2013/05/index.html'>May 2013</a></li>
	<li><a href='../../../../2012/12/index.html'>December 2012</a></li>
	<li><a href='../../../../2012/11/index.html'>November 2012</a></li>
	<li><a href='../../../../2012/06/index.html'>June 2012</a></li>
	<li><a href='../../../../2012/04/index.html'>April 2012</a></li>
	<li><a href='../../../../2012/03/index.html'>March 2012</a></li>
	<li><a href='../../../../2012/01/index.html'>January 2012</a></li>
	<li><a href='../../../../2011/10/index.html'>October 2011</a></li>
	<li><a href='../../../../2011/09/index.html'>September 2011</a></li>
	<li><a href='../../../../2011/06/index.html'>June 2011</a></li>
	<li><a href='../../../../2011/05/index.html'>May 2011</a></li>
	<li><a href='../../../../2011/04/index.html'>April 2011</a></li>
	<li><a href='../../../../2011/03/index.html'>March 2011</a></li>
	<li><a href='../../../../2011/02/index.html'>February 2011</a></li>
	<li><a href='../../../../2011/01/index.html'>January 2011</a></li>
	<li><a href='../../../../2010/11/index.html'>November 2010</a></li>
	<li><a href='../../../../2010/09/index.html'>September 2010</a></li>
	<li><a href='../../../../2010/07/index.html'>July 2010</a></li>
	<li><a href='../../../../2010/06/index.html'>June 2010</a></li>
	<li><a href='../../../../2010/05/index.html'>May 2010</a></li>
	<li><a href='../../../../2010/04/index.html'>April 2010</a></li>
	<li><a href='../../../../2010/03/index.html'>March 2010</a></li>
	<li><a href='../../../../2010/01/index.html'>January 2010</a></li>
	<li><a href='../../../../2009/12/index.html'>December 2009</a></li>
	<li><a href='../../../../2009/10/index.html'>October 2009</a></li>
	<li><a href='../../../../2006/05/index.html'>May 2006</a></li>
	<li><a href='../../../../2006/04/index.html'>April 2006</a></li>
		</ul>
</div><div class="block meta-3 widget_meta"><h3>Meta</h3>			<ul>
						<li><a href="../../../../wp-login.php">Log in</a></li>
			<li><a href="../../../../feed/index.html">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="../../../../comments/feed/index.html">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</div><div class="block advman-3 Advman_Widget"><h3>Google Ads</h3><script type="text/javascript"><!--
google_ad_client = "pub-9101413482443756";
/* Basic header */
google_ad_slot = "3471816671";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>	</div>

	<div id="footer">	
	<p>&copy; Copyright 2015 | <a href="../../../../index.html">chmullig.com</a> | All Rights Reserved</p>
	<p>		<!-- Advertising Manager v3.4.28 (0.370 seconds.) -->
	<div style="display:none">
	</div>
<script type="text/javascript">
var addthis_options = "facebook,twitter,hackernews,reddit,google_plusone";
var addthis_config = {"data_track_clickback":false,"data_ga_property":"UA-11155757-1","data_ga_social":true,"data_track_addressbar":false,"data_track_textcopy":false,"ui_language":"en","ui_atversion":"300"};
var addthis_product = 'wpp-3.5.9';
</script><script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=chmullig"></script><script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201524'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2015Junaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.2.2'></script>

	<script src="http://stats.wp.com/e-201524.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:3.1.2',blog:'37239074',post:'0',tz:'-4'});
	var load_cmc = function(){linktracker_init(37239074,0,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script><!--wp_footer--></p>
	</div>

</div>

<!-- Can put web stats code here -->

</body>

</html>
<!-- Dynamic page generated in 0.367 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2015-06-13 00:20:30 -->

<!-- super cache -->